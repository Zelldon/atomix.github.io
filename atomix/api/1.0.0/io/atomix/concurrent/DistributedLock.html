<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DistributedLock (Atomix API Reference (1.0.0))</title>
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="DistributedLock (Atomix API Reference (1.0.0))";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DistributedLock.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?io/atomix/concurrent/DistributedLock.html" target="_top">Frames</a></li>
<li><a href="DistributedLock.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.atomix.concurrent</div>
<h2 title="Class DistributedLock" class="title">Class DistributedLock</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../io/atomix/resource/AbstractResource.html" title="class in io.atomix.resource">io.atomix.resource.AbstractResource</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;</li>
<li>
<ul class="inheritance">
<li>io.atomix.concurrent.DistributedLock</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="http://atomix.io/catalyst/api/latest/io/atomix/catalyst/util/Managed.html?is-external=true" title="class or interface in io.atomix.catalyst.util">Managed</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;, <a href="../../../io/atomix/resource/Resource.html" title="interface in io.atomix.resource">Resource</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;</dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">DistributedLock</span>
extends <a href="../../../io/atomix/resource/AbstractResource.html" title="class in io.atomix.resource">AbstractResource</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;</pre>
<div class="block">Facilitates synchronizing access to cluster-wide shared resources.
 <p>
 The distributed lock resource provides a mechanism for nodes to synchronize access to cluster-wide shared resources.
 This interface is an asynchronous version of Java's <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/Lock.html?is-external=true" title="class or interface in java.util.concurrent.locks"><code>Lock</code></a>.
 <pre>
   <code>
   atomix.getLock("my-lock").thenAccept(lock -&gt; {
     lock.lock().thenRun(() -&gt; {
       ...
       lock.unlock();
     });
   });
   </code>
 </pre>
 Locks are implemented as a simple replicated queue that tracks which client currently holds a lock. When a lock
 is <a href="../../../io/atomix/concurrent/DistributedLock.html#lock--"><code>locked</code></a>, if the lock is available then the requesting resource instance will immediately receive
 the lock, otherwise the lock request will be queued. When a lock is <a href="../../../io/atomix/concurrent/DistributedLock.html#unlock--"><code>unlocked</code></a>, the next lock requester
 will be granted the lock.
 <p>
 Distributed locks require no polling from the client. Locks are granted via session events published by the Atomix
 cluster to the lock instance. In the event that a lock's client becomes disconnected from the cluster, its session
 will expire after the configured cluster session timeout and the lock will be automatically released.
 <h2>Detecting failures</h2>
 Once a lock is acquired by a client, the cluster will monitor the lock holder's availability and release the lock
 automatically if the client becomes disconnected from the cluster. However, in the event that a lock holder becomes
 disconnected without crashing, it's possible for two processes to believe themselves to hold the lock simultaneously.
 If the lock holder becomes disconnected the cluster may grant the lock to another process. For this reason it's essential
 that clients monitor the <a href="../../../io/atomix/resource/Resource.State.html" title="enum in io.atomix.resource"><code>State</code></a> of the lock. If the resource transitions to the
 <code>Resource.State#SUSPENDED</code> state, that indicates that the underlying client is unable to communicate with the
 cluster and another process may have been granted the lock. Lock holders should monitor the resource for state changes
 and release the lock if the resource becomes suspended.
 <p>
 <pre>
   <code>
   DistributedLock lock = atomix.getLock("my-lock").get();

   lock.lock().thenRun(() -&gt; {
     lock.onStateChange(state -&gt; {
       if (state == DistributedLock.State.SUSPENDED) {
         lock.unlock();
         System.out.println("lost the lock");
       }
     });
     // Do stuff
   });
   </code>
 </pre>
 <h2>Fencing</h2>
 Detecting state changes in the lock client's session may not always be sufficient for determining whether the
 local resource instance is the unique lock holder in the cluster. For instance, a lengthy garbage collection
 pause can result in the client's session expiring without any change to the client's session state, resulting
 in another process being granted the lock. To account for arbitrary lapses in time, the <code>DistributedLock</code>
 provides a monotonically increasing, globally unique identifier to each process granted the lock. The token can
 be used for optimistic concurrency control when accessing external resources.
 <pre>
   <code>
   lock.lock().thenAccept(token -&gt; {
     // Write to external data store, checking that the last written token is not greater than the current token
   });
   </code>
 </pre>
 This is known as a fencing token. When using the lock to control concurrent writes to e.g. an external data
 store, the monotonically increasing identifier provided when the lock is granted allows lock holders to
 optimistically determine whether the lock has been granted to a more recent lock requester that has written
 to the data store. If the last write to the external data store is greater than the local lock's token, that
 indicates that another process has been granted the lock.
 <h3>Implementation</h3>
 Lock state management is implemented in a Copycat replicated <a href="http://atomix.io/copycat/api/latest/io/atomix/copycat/server/StateMachine.html?is-external=true" title="class or interface in io.atomix.copycat.server"><code>StateMachine</code></a>.
 When a lock is created, an instance of the lock state machine is created on each replica in the cluster.
 The state machine instance manages state for the specific lock. When a client makes a <a href="../../../io/atomix/concurrent/DistributedLock.html#lock--"><code>lock()</code></a>
 request, it submits the request with a monotonically increasing identifier unique to the resource instance.
 If the lock is not currently held by another process, the state machine grants the lock to the
 requester and <a href="http://atomix.io/copycat/api/latest/io/atomix/copycat/server/session/ServerSession.html?is-external=true#publish-java.lang.String-java.lang.Object-" title="class or interface in io.atomix.copycat.server.session"><code>publishes</code></a>
 a <code>lock</code> event with the requested lock ID and a globally unique, monotonically increasing token to
 the client. If the lock is held by another process, the lock request is enqueued to await availability of
 the lock.
 <p>
 When a client-side <code>DistributedLock</code> receives a published <code>lock</code> event from the cluster, the
 client associates the lock ID with a lock requested by the client and grants the lock to the requester.
 The globally unique, monotonically increasing token provided by the cluster is provided to the user as
 a fencing token. Because of garbage collection and other types of process pauses, we cannot guarantee that
 two clients cannot perceive themselves to hold the same lock at the same time. The fencing token provides
 a mechanism for optimistic locking when interacting with external resources.
 <p>
 When a lock holder <a href="../../../io/atomix/concurrent/DistributedLock.html#unlock--"><code>unlocks</code></a> a lock, a second request is sent to the cluster. The <code>unlock</code>
 request is logged and replicated to a majority of the cluster and applied to the replicated state machine.
 If another lock requester is awaiting the lock, the state machine will grant the lock to the next requester
 in the queue.
 <p>
 Because a lock holder may become partitioned or crash before releasing a lock, the lock state machine is responsible
 for tracking which session currently holds the lock. In the event that the lock holder is partitioned or crashes,
 its session will eventually be expired by the state machine, and the lock will be granted to the next requester
 in the queue.
 <p>
 The lock state machine manages compaction in the replicated log by tracking which <code>lock</code> and <code>unlock</code>
 requests contribute to the state of the lock. As long as a client holds a lock, the commit requesting the lock
 will be retained in the replicated log. And as long as a client's request to acquire a lock is held in the state
 machine's lock queue, the commit requesting the lock will be retained in the replicated log. This ensures that if
 a replica crashes and recovers it will recover the correct state of the lock. Once a lock is released by a client,
 both the <code>lock</code> and <code>unlock</code> commit associated with the lock will be released from the state machine
 and eventually removed from the log during compaction.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd><a href="http://github.com/kuujo">Jordan Halterman</a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="nested.classes.inherited.from.class.io.atomix.resource.Resource">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from interface&nbsp;io.atomix.resource.<a href="../../../io/atomix/resource/Resource.html" title="interface in io.atomix.resource">Resource</a></h3>
<code><a href="../../../io/atomix/resource/Resource.Config.html" title="class in io.atomix.resource">Resource.Config</a>, <a href="../../../io/atomix/resource/Resource.Options.html" title="class in io.atomix.resource">Resource.Options</a>, <a href="../../../io/atomix/resource/Resource.State.html" title="enum in io.atomix.resource">Resource.State</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../io/atomix/concurrent/DistributedLock.html#DistributedLock-io.atomix.copycat.client.CopycatClient-java.util.Properties-">DistributedLock</a></span>(<a href="http://atomix.io/copycat/api/latest/io/atomix/copycat/client/CopycatClient.html?is-external=true" title="class or interface in io.atomix.copycat.client">CopycatClient</a>&nbsp;client,
               <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Properties.html?is-external=true" title="class or interface in java.util">Properties</a>&nbsp;options)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/atomix/concurrent/DistributedLock.html#lock--">lock</a></span>()</code>
<div class="block">Acquires the lock.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/atomix/concurrent/DistributedLock.html#open--">open</a></span>()</code>
<div class="block">Opens the resource.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/atomix/concurrent/DistributedLock.html#tryLock--">tryLock</a></span>()</code>
<div class="block">Attempts to acquire the lock if available.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/atomix/concurrent/DistributedLock.html#tryLock-java.time.Duration-">tryLock</a></span>(<a href="http://docs.oracle.com/javase/8/docs/api/java/time/Duration.html?is-external=true" title="class or interface in java.time">Duration</a>&nbsp;timeout)</code>
<div class="block">Attempts to acquire the lock if available within the given timeout.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Void.html?is-external=true" title="class or interface in java.lang">Void</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/atomix/concurrent/DistributedLock.html#unlock--">unlock</a></span>()</code>
<div class="block">Releases the lock.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.io.atomix.resource.AbstractResource">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;io.atomix.resource.<a href="../../../io/atomix/resource/AbstractResource.html" title="class in io.atomix.resource">AbstractResource</a></h3>
<code><a href="../../../io/atomix/resource/AbstractResource.html#close--">close</a>, <a href="../../../io/atomix/resource/AbstractResource.html#config--">config</a>, <a href="../../../io/atomix/resource/AbstractResource.html#context--">context</a>, <a href="../../../io/atomix/resource/AbstractResource.html#delete--">delete</a>, <a href="../../../io/atomix/resource/AbstractResource.html#equals-java.lang.Object-">equals</a>, <a href="../../../io/atomix/resource/AbstractResource.html#hashCode--">hashCode</a>, <a href="../../../io/atomix/resource/AbstractResource.html#isClosed--">isClosed</a>, <a href="../../../io/atomix/resource/AbstractResource.html#isOpen--">isOpen</a>, <a href="../../../io/atomix/resource/AbstractResource.html#onStateChange-java.util.function.Consumer-">onStateChange</a>, <a href="../../../io/atomix/resource/AbstractResource.html#options--">options</a>, <a href="../../../io/atomix/resource/AbstractResource.html#serializer--">serializer</a>, <a href="../../../io/atomix/resource/AbstractResource.html#state--">state</a>, <a href="../../../io/atomix/resource/AbstractResource.html#toString--">toString</a>, <a href="../../../io/atomix/resource/AbstractResource.html#type--">type</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="DistributedLock-io.atomix.copycat.client.CopycatClient-java.util.Properties-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DistributedLock</h4>
<pre>public&nbsp;DistributedLock(<a href="http://atomix.io/copycat/api/latest/io/atomix/copycat/client/CopycatClient.html?is-external=true" title="class or interface in io.atomix.copycat.client">CopycatClient</a>&nbsp;client,
                       <a href="http://docs.oracle.com/javase/8/docs/api/java/util/Properties.html?is-external=true" title="class or interface in java.util">Properties</a>&nbsp;options)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="open--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>open</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;&nbsp;open()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../io/atomix/resource/Resource.html#open--">Resource</a></code></span></div>
<div class="block">Opens the resource.
 <p>
 Once the resource is opened, the resource will be transitioned to the <a href="../../../io/atomix/resource/Resource.State.html#CONNECTED"><code>Resource.State.CONNECTED</code></a> state
 and the returned <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> will be completed.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="http://atomix.io/catalyst/api/latest/io/atomix/catalyst/util/Managed.html?is-external=true#open--" title="class or interface in io.atomix.catalyst.util">open</a></code>&nbsp;in interface&nbsp;<code><a href="http://atomix.io/catalyst/api/latest/io/atomix/catalyst/util/Managed.html?is-external=true" title="class or interface in io.atomix.catalyst.util">Managed</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;</code></dd>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../io/atomix/resource/Resource.html#open--">open</a></code>&nbsp;in interface&nbsp;<code><a href="../../../io/atomix/resource/Resource.html" title="interface in io.atomix.resource">Resource</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;</code></dd>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../io/atomix/resource/AbstractResource.html#open--">open</a></code>&nbsp;in class&nbsp;<code><a href="../../../io/atomix/resource/AbstractResource.html" title="class in io.atomix.resource">AbstractResource</a>&lt;<a href="../../../io/atomix/concurrent/DistributedLock.html" title="class in io.atomix.concurrent">DistributedLock</a>&gt;</code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A completable future to be completed once the resource is opened.</dd>
</dl>
</li>
</ul>
<a name="lock--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lock</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;&nbsp;lock()</pre>
<div class="block">Acquires the lock.
 <p>
 When the lock is acquired, this lock instance will publish a lock request to the cluster and await
 an event granting the lock to this instance. The returned <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> will not be completed
 until the lock has been acquired.
 <p>
 Once the lock is granted, the returned future will be completed with a positive <code>Long</code> value. This value
 is guaranteed to be unique across all clients and monotonically increasing. Thus, the value can be used as a
 fencing token for further concurrency control.
 <p>
 This method returns a <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> which can be used to block until the operation completes
 or to be notified in a separate thread once the operation completes. To block until the operation completes,
 use the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true#join--" title="class or interface in java.util.concurrent"><code>CompletableFuture.join()</code></a> method to block the calling thread:
 <pre>
   <code>
   lock.lock().join();
   </code>
 </pre>
 Alternatively, to execute the operation asynchronous and be notified once the lock is acquired in a different
 thread, use one of the many completable future callbacks:
 <pre>
   <code>
   lock.lock().thenRun(() -&gt; System.out.println("Lock acquired!"));
   </code>
 </pre></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A completable future to be completed once the lock has been acquired.</dd>
</dl>
</li>
</ul>
<a name="tryLock--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryLock</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;&nbsp;tryLock()</pre>
<div class="block">Attempts to acquire the lock if available.
 <p>
 When the lock is acquired, this lock instance will publish an immediate lock request to the cluster. If the
 lock is available, the lock will be granted and the returned <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> will be completed
 successfully. If the lock is not immediately available, the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> will be completed
 with a <code>null</code> value.
 <p>
 If the lock is granted, the returned future will be completed with a positive <code>Long</code> value. This value
 is guaranteed to be unique across all clients and monotonically increasing. Thus, the value can be used as a
 fencing token for further concurrency control.
 <p>
 This method returns a <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> which can be used to block until the operation completes
 or to be notified in a separate thread once the operation completes. To block until the operation completes,
 use the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true#get--" title="class or interface in java.util.concurrent"><code>CompletableFuture.get()</code></a> method to block the calling thread:
 <pre>
   <code>
   if (lock.tryLock().get()) {
     System.out.println("Lock acquired!");
   } else {
     System.out.println("Lock failed!");
   }
   </code>
 </pre>
 Alternatively, to execute the operation asynchronous and be notified once the lock is acquired in a different
 thread, use one of the many completable future callbacks:
 <pre>
   <code>
   lock.tryLock().thenAccept(locked -&gt; {
     if (locked) {
       System.out.println("Lock acquired!");
     } else {
       System.out.println("Lock failed!");
     }
   });
   </code>
 </pre></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A completable future to be completed with a boolean indicating whether the lock was acquired.</dd>
</dl>
</li>
</ul>
<a name="tryLock-java.time.Duration-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tryLock</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html?is-external=true" title="class or interface in java.lang">Long</a>&gt;&nbsp;tryLock(<a href="http://docs.oracle.com/javase/8/docs/api/java/time/Duration.html?is-external=true" title="class or interface in java.time">Duration</a>&nbsp;timeout)</pre>
<div class="block">Attempts to acquire the lock if available within the given timeout.
 <p>
 When the lock is acquired, this lock instance will publish an immediate lock request to the cluster. If the
 lock is available, the lock will be granted and the returned <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> will be completed
 successfully. If the lock is not immediately available, the lock request will be queued until the lock comes
 available. If the lock <code>timeout</code> expires, the lock request will be cancelled and the returned
 <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> will be completed successfully with a <code>null</code> result.
 <p>
 If the lock is granted, the returned future will be completed with a positive <code>Long</code> value. This value
 is guaranteed to be unique across all clients and monotonically increasing. Thus, the value can be used as a
 fencing token for further concurrency control.
 <p>
 <b>Timeouts and wall-clock time</b>
 The provided <code>timeout</code> may not ultimately be representative of the actual timeout in the cluster. Because
 of clock skew and determinism requirements, the actual timeout may be arbitrarily greater, but not less, than
 the provided <code>timeout</code>. However, time will always progress monotonically. That is, time will never go
 in reverse. A timeout of <code>10</code> seconds will always be greater than a timeout of <code>9</code> seconds, but the
 times simply may not match actual wall-clock time.
 <p>
 This method returns a <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> which can be used to block until the operation completes
 or to be notified in a separate thread once the operation completes. To block until the operation completes,
 use the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true#get--" title="class or interface in java.util.concurrent"><code>CompletableFuture.get()</code></a> method to block the calling thread:
 <pre>
   <code>
   if (lock.tryLock(Duration.ofSeconds(10)).get()) {
     System.out.println("Lock acquired!");
   } else {
     System.out.println("Lock failed!");
   }
   </code>
 </pre>
 Alternatively, to execute the operation asynchronous and be notified once the lock is acquired in a different
 thread, use one of the many completable future callbacks:
 <pre>
   <code>
   lock.tryLock(Duration.ofSeconds(10)).thenAccept(locked -&gt; {
     if (locked) {
       System.out.println("Lock acquired!");
     } else {
       System.out.println("Lock failed!");
     }
   });
   </code>
 </pre></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timeout</code> - The duration within which to acquire the lock.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A completable future to be completed with a value indicating whether the lock was acquired.</dd>
</dl>
</li>
</ul>
<a name="unlock--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>unlock</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent">CompletableFuture</a>&lt;<a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Void.html?is-external=true" title="class or interface in java.lang">Void</a>&gt;&nbsp;unlock()</pre>
<div class="block">Releases the lock.
 <p>
 When the lock is released, the lock instance will publish an unlock request to the cluster. Once the lock has
 been released, if any other instances of this resource are waiting for a lock on this or another node, the lock
 will be acquired by the waiting instance before this unlock operation is completed. Once the lock has been released
 and granted to any waiters, the returned <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> will be completed.
 <p>
 This method returns a <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true" title="class or interface in java.util.concurrent"><code>CompletableFuture</code></a> which can be used to block until the operation completes
 or to be notified in a separate thread once the operation completes. To block until the operation completes,
 use the <a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html?is-external=true#join--" title="class or interface in java.util.concurrent"><code>CompletableFuture.join()</code></a> method to block the calling thread:
 <pre>
   <code>
   lock.unlock().join();
   </code>
 </pre>
 Alternatively, to execute the operation asynchronous and be notified once the lock is acquired in a different
 thread, use one of the many completable future callbacks:
 <pre>
   <code>
   lock.unlock().thenRun(() -&gt; System.out.println("Lock released!"));
   </code>
 </pre></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A completable future to be completed once the lock has been released.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DistributedLock.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?io/atomix/concurrent/DistributedLock.html" target="_top">Frames</a></li>
<li><a href="DistributedLock.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2013&#x2013;2016. All rights reserved.</small></p>
</body>
</html>
