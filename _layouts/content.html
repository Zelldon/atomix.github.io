{% assign site.manual-url = site.baseurl | concat "/user-manua" %}

<!DOCTYPE html>
<html lang="en">
{% include head.html %}
	<body>

{% include header.html %}

<div class="header page-header">
  <div class="container">
    <div class="row">
      <div class="col-sm-12">
        <h1>{{ page.title }} </h1>
      </div>
    </div>
  </div>
</div>

<div class="doc-container container">
	<div class="row">
{% if page.menu %}
    <div class="col-md-9 docs">
{% else %}
    <div class="col-md-12 docs">
{% endif %}

{% if page.pitch %}
<h2 class="pitch" id="{{ page.first-section }}">&#62; {{ page.pitch }}</h2>
{% endif %}

{% if page.menu %}
      <div class="hidden-md hidden-lg" id="toc">
        <h3>Table of Contents</h3>
  {% if page.menu == "user-manual" %}
    {% capture toc %}{% include user-manual-menu.md %}{% endcapture %}
  {% elsif page.menu == "getting-started" %}
    {% capture toc %}{% include getting-started-menu.md %}{% endcapture %}
  {% endif %}
{{ toc | markdownify }}
      </div>
{% endif %}

{{ content }}
    </div><!-- End col -->

{% if page.menu %}
      <div class="col-md-3 hidden-xs hidden-sm" id="sidebar-col" >
        <div class="nav affix-top" id="sidebar">
{% if page.menu == "getting-started" %}
{% capture sidemenu %}{% include getting-started-menu.md %}{% endcapture %}
{% elsif page.menu == "user-manual" %}
{% capture sidemenu %}{% include user-manual-menu.md %}{% endcapture %}
{% endif %}
{{ sidemenu | markdownify }}
        </div>
      </div>
{% endif %}

    </div>
  </div>

{% include footer.html %}

{% include scripts.html %}

<script type="text/javascript">
  var currentPath = window.location.pathname

  // Adjust user manual TOC when for small screens
  $("#toc > ul > li > a").each(function() {
    var parentRef = $(this).attr('href');
    if (currentPath.indexOf(parentRef) > -1) {
      $(this).parent().css('display', 'block');
    }
  });

  // Adjust sidebar links
  $("#sidebar > ul > li > a").each(function() {
    var parentRef = $(this).attr('href');
    var gettingStarted = parentRef == "getting-started";

    // Activate current sidebar item
    if (currentPath.indexOf(parentRef) > -1) {
      $(this).parent().attr('class', 'current');
    }

    var newRef = '{{ site.baseurl }}/' + (gettingStarted ? parentRef : '{{ page.menu }}/' + parentRef);
    $(this).attr('href', newRef);
    $(this).attr('data-target', '#' + parentRef);
    
    $(this).parent().find("ul > li a").each(function () {
      var childHref = $(this).attr('href');
      if (!gettingStarted)
        $(this).attr('href', newRef + childHref);
      $(this).attr('data-target', childHref);
    });
  });
</script>

	</body>
</html>