<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>OffsetIndex (Copycat API Reference (latest))</title>
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="OffsetIndex (Copycat API Reference (latest))";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6,"i10":17,"i11":6};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],16:["t5","Default Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/OffsetIndex.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../io/atomix/copycat/server/storage/index/DelegatingOffsetIndex.html" title="class in io.atomix.copycat.server.storage.index"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../io/atomix/copycat/server/storage/index/SearchableOffsetIndex.html" title="class in io.atomix.copycat.server.storage.index"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?io/atomix/copycat/server/storage/index/OffsetIndex.html" target="_top">Frames</a></li>
<li><a href="OffsetIndex.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.atomix.copycat.server.storage.index</div>
<h2 title="Interface OffsetIndex" class="title">Interface OffsetIndex</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang">AutoCloseable</a></dd>
</dl>
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../../../io/atomix/copycat/server/storage/index/DelegatingOffsetIndex.html" title="class in io.atomix.copycat.server.storage.index">DelegatingOffsetIndex</a>, <a href="../../../../../../io/atomix/copycat/server/storage/index/SearchableOffsetIndex.html" title="class in io.atomix.copycat.server.storage.index">SearchableOffsetIndex</a>, <a href="../../../../../../io/atomix/copycat/server/storage/index/SequentialOffsetIndex.html" title="class in io.atomix.copycat.server.storage.index">SequentialOffsetIndex</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">OffsetIndex</span>
extends <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang">AutoCloseable</a></pre>
<div class="block">Segment offset index.
 <p>
 The offset index handles indexing of entries in a given <a href="../../../../../../io/atomix/copycat/server/storage/Segment.html" title="class in io.atomix.copycat.server.storage"><code>Segment</code></a>. Given the offset and position of an entry
 in a segment, the index will write the position to an underlying <a href="http://atomix.io/catalyst/api/latest/io/atomix/catalyst/buffer/Buffer.html?is-external=true" title="class or interface in io.atomix.catalyst.buffer"><code>Buffer</code></a>. With this information, the index provides
 useful metadata about the log such as the number of physical entries in the log and the first and last offsets.
 <p>
 Each entry in the index is stored in 8 bytes, a 1 byte status flag, a 24-bit unsigned offset, and a 32-bit unsigned
 position. This places a limitation on the maximum indexed offset at <code>2^31 - 1</code> and maximum indexed position at
 <code>2^32 - 1</code>.
 <p>
 When the index is first created, the <a href="http://atomix.io/catalyst/api/latest/io/atomix/catalyst/buffer/Buffer.html?is-external=true" title="class or interface in io.atomix.catalyst.buffer"><code>Buffer</code></a> provided to the constructor will be scanned for existing entries.
 <p>
 The index assumes that entries will always be indexed in increasing order. However, this index also allows arbitrary
 entries to be missing from the log due to log compaction. Because of the potential for missing entries, binary search
 is used to locate positions rather than absolute positions. For efficiency, a <a href="http://atomix.io/catalyst/api/latest/io/atomix/catalyst/buffer/MappedBuffer.html?is-external=true" title="class or interface in io.atomix.catalyst.buffer"><code>MappedBuffer</code></a>
 can be used to improve the performance of the binary search algorithm for persistent indexes.
 <p>
 In order to prevent searching the index for missing entries, all offsets are added to a memory efficient <a href="http://atomix.io/catalyst/api/latest/io/atomix/catalyst/buffer/util/BitArray.html?is-external=true" title="class or interface in io.atomix.catalyst.buffer.util"><code>BitArray</code></a>
 as they're written to the index. The bit array is sized according to the underlying index buffer. Prior to searching
 for an offset in the index, the <a href="http://atomix.io/catalyst/api/latest/io/atomix/catalyst/buffer/util/BitArray.html?is-external=true" title="class or interface in io.atomix.catalyst.buffer.util"><code>BitArray</code></a> is checked for existence of the offset in the index. Only if the offset
 exists in the index is a binary search required.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd><a href="http://github.com/kuujo">Jordan Halterman</a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t5" class="tableTab"><span><a href="javascript:show(16);">Default Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#close--">close</a></span>()</code>
<div class="block">Closes the index.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#contains-long-">contains</a></span>(long&nbsp;offset)</code>
<div class="block">Returns a boolean value indicating whether the index contains the given offset.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#delete--">delete</a></span>()</code>
<div class="block">Deletes the index.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#find-long-">find</a></span>(long&nbsp;offset)</code>
<div class="block">Finds the real offset for the given relative offset.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#flush--">flush</a></span>()</code>
<div class="block">Flushes the index to the underlying storage.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#index-long-long-">index</a></span>(long&nbsp;offset,
     long&nbsp;position)</code>
<div class="block">Indexes the given offset with the given position.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#isEmpty--">isEmpty</a></span>()</code>
<div class="block">Returns a boolean value indicating whether the index is empty.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#lastOffset--">lastOffset</a></span>()</code>
<div class="block">Returns the last offset in the index.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#position-long-">position</a></span>(long&nbsp;offset)</code>
<div class="block">Finds the starting position of the given offset.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#size--">size</a></span>()</code>
<div class="block">Returns the number of entries active in the index.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#size-int-">size</a></span>(int&nbsp;maxEntries)</code>
<div class="block">Returns the count of the index for the given number of entries.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/copycat/server/storage/index/OffsetIndex.html#truncate-long-">truncate</a></span>(long&nbsp;offset)</code>
<div class="block">Truncates the index up to the given offset.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="size-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>size</h4>
<pre>static&nbsp;long&nbsp;size(int&nbsp;maxEntries)</pre>
<div class="block">Returns the count of the index for the given number of entries.</div>
</li>
</ul>
<a name="lastOffset--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastOffset</h4>
<pre>long&nbsp;lastOffset()</pre>
<div class="block">Returns the last offset in the index.</div>
</li>
</ul>
<a name="index-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>index</h4>
<pre>boolean&nbsp;index(long&nbsp;offset,
              long&nbsp;position)</pre>
<div class="block">Indexes the given offset with the given position.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>offset</code> - The offset to index.</dd>
<dd><code>position</code> - The position of the offset to index.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Indicates whether the offset was successfully indexed.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if the <code>offset</code> is less than or equal to the last offset in the index, 
 or <code>position</code> is greater than MAX_POSITION</dd>
</dl>
</li>
</ul>
<a name="isEmpty--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isEmpty</h4>
<pre>boolean&nbsp;isEmpty()</pre>
<div class="block">Returns a boolean value indicating whether the index is empty.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Indicates whether the index is empty.</dd>
</dl>
</li>
</ul>
<a name="size--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>size</h4>
<pre>int&nbsp;size()</pre>
<div class="block">Returns the number of entries active in the index.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of entries active in the index.</dd>
</dl>
</li>
</ul>
<a name="contains-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>contains</h4>
<pre>boolean&nbsp;contains(long&nbsp;offset)</pre>
<div class="block">Returns a boolean value indicating whether the index contains the given offset.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>offset</code> - The offset to check.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Indicates whether the index contains the given offset.</dd>
</dl>
</li>
</ul>
<a name="position-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>position</h4>
<pre>long&nbsp;position(long&nbsp;offset)</pre>
<div class="block">Finds the starting position of the given offset.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>offset</code> - The offset to look up.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The starting position of the given offset.</dd>
</dl>
</li>
</ul>
<a name="find-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>find</h4>
<pre>long&nbsp;find(long&nbsp;offset)</pre>
<div class="block">Finds the real offset for the given relative offset.</div>
</li>
</ul>
<a name="truncate-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>truncate</h4>
<pre>long&nbsp;truncate(long&nbsp;offset)</pre>
<div class="block">Truncates the index up to the given offset.
 <p>
 This method assumes that the given offset is contained within the index. If the offset is not indexed then the
 index will not be truncated.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>offset</code> - The offset after which to truncate the index.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The position of the last entry in the index.</dd>
</dl>
</li>
</ul>
<a name="flush--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flush</h4>
<pre>void&nbsp;flush()</pre>
<div class="block">Flushes the index to the underlying storage.</div>
</li>
</ul>
<a name="close--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>void&nbsp;close()</pre>
<div class="block">Closes the index.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true#close--" title="class or interface in java.lang">close</a></code>&nbsp;in interface&nbsp;<code><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html?is-external=true" title="class or interface in java.lang">AutoCloseable</a></code></dd>
</dl>
</li>
</ul>
<a name="delete--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>delete</h4>
<pre>void&nbsp;delete()</pre>
<div class="block">Deletes the index.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/OffsetIndex.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../io/atomix/copycat/server/storage/index/DelegatingOffsetIndex.html" title="class in io.atomix.copycat.server.storage.index"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../io/atomix/copycat/server/storage/index/SearchableOffsetIndex.html" title="class in io.atomix.copycat.server.storage.index"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?io/atomix/copycat/server/storage/index/OffsetIndex.html" target="_top">Frames</a></li>
<li><a href="OffsetIndex.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2013&#x2013;2017. All rights reserved.</small></p>
</body>
</html>
