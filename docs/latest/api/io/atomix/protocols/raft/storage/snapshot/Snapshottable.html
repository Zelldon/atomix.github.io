<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Snapshottable (Atomix API Reference (2.1.0))</title>
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="Snapshottable (Atomix API Reference (2.1.0))";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Snapshottable.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotStore.html" title="class in io.atomix.protocols.raft.storage.snapshot"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotWriter.html" title="class in io.atomix.protocols.raft.storage.snapshot"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?io/atomix/protocols/raft/storage/snapshot/Snapshottable.html" target="_top">Frames</a></li>
<li><a href="Snapshottable.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.atomix.protocols.raft.storage.snapshot</div>
<h2 title="Interface Snapshottable" class="title">Interface Snapshottable</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public interface <span class="typeNameLabel">Snapshottable</span></pre>
<div class="block">Support for periodically persisting <a href="../../../../../../io/atomix/primitive/service/PrimitiveService.html" title="interface in io.atomix.primitive.service"><code>PrimitiveService</code></a> snapshots to disk.
 <p>
 To store a state machine's state, simply implement the <a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/Snapshottable.html#snapshot-io.atomix.protocols.raft.storage.snapshot.SnapshotWriter-"><code>snapshot(SnapshotWriter)</code></a> method and write the
 complete state machine state to the snapshot via the <a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotWriter.html" title="class in io.atomix.protocols.raft.storage.snapshot"><code>SnapshotWriter</code></a>. Raft will periodically invoke
 the method to take a new snapshot of the state machine's state when the underlying log rotates segments.
 <p>
 <pre>
   <code>
   public class MyStateMachine extends StateMachine implements Snapshottable {
     private long counter;

     public void snapshot(SnapshotWriter writer) {
       writer.writeLong(counter);
     }

     public long increment(Commit&lt;Increment&gt; commit) {
       counter++;
     }
   }
   </code>
 </pre>
 Snapshot writing is only one component of snapshotting. Snapshottable state machines must also be able to
 recover from snapshots stored on disk after a failure. When a server recovers from an existing Raft log,
 the log will be replayed to the state machine, and when a point in logical time (an <code>index</code>) at which
 a snapshot was taken and persisted is reached, that snapshot will be applied to the state machine via the
 <a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/Snapshottable.html#install-io.atomix.protocols.raft.storage.snapshot.SnapshotReader-"><code>install(SnapshotReader)</code></a> method.
 <p>
 <pre>
   <code>
   public class MyStateMachine extends StateMachine implements Snapshottable {
     private long counter;

     public void install(SnapshotReader reader) {
       counter = reader.readLong();
     }
   }
   </code>
 </pre>
 Implementations of the <a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/Snapshottable.html#install-io.atomix.protocols.raft.storage.snapshot.SnapshotReader-"><code>install(SnapshotReader)</code></a> method should always read precisely what implementations
 of <a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/Snapshottable.html#snapshot-io.atomix.protocols.raft.storage.snapshot.SnapshotWriter-"><code>snapshot(SnapshotWriter)</code></a> write. State machines can potentially use a mixture of <code>SNAPSHOT</code>
 and other commands, and state machine implementations should take care not to overwrite non-snapshot command
 state with snapshots. For simpler state machines, <em>users should use either snapshotting or log cleaning
 but not both</em>.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/Snapshottable.html#install-io.atomix.protocols.raft.storage.snapshot.SnapshotReader-">install</a></span>(<a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotReader.html" title="class in io.atomix.protocols.raft.storage.snapshot">SnapshotReader</a>&nbsp;reader)</code>
<div class="block">Installs a snapshot of the state machine state.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/Snapshottable.html#snapshot-io.atomix.protocols.raft.storage.snapshot.SnapshotWriter-">snapshot</a></span>(<a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotWriter.html" title="class in io.atomix.protocols.raft.storage.snapshot">SnapshotWriter</a>&nbsp;writer)</code>
<div class="block">Takes a snapshot of the state machine state.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="snapshot-io.atomix.protocols.raft.storage.snapshot.SnapshotWriter-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>snapshot</h4>
<pre>void&nbsp;snapshot(<a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotWriter.html" title="class in io.atomix.protocols.raft.storage.snapshot">SnapshotWriter</a>&nbsp;writer)</pre>
<div class="block">Takes a snapshot of the state machine state.
 <p>
 This method will be called each time the underlying <a href="../../../../../../io/atomix/protocols/raft/storage/log/RaftLog.html" title="class in io.atomix.protocols.raft.storage.log"><code>Log</code></a>
 rotates segments. Once the snapshot has been written, the snapshot will be stored on disk and eventually
 completed. Note that snapshots are normally not immediately completed upon completion of this method as
 servers must wait for certain conditions to be met before persisting a snapshot. Therefore, state machines
 should not assume that once a snapshot has been written that the state machine can or will recover from
 that snapshot. Snapshot writers should also ensure that all snapshottable state machine state is written on
 each snapshot. Typically, only the most recent snapshot is applied to a state machine upon recovery, so no
 assumptions should be made about the persistence or retention of older snapshots.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>writer</code> - The snapshot writer.</dd>
</dl>
</li>
</ul>
<a name="install-io.atomix.protocols.raft.storage.snapshot.SnapshotReader-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>install</h4>
<pre>void&nbsp;install(<a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotReader.html" title="class in io.atomix.protocols.raft.storage.snapshot">SnapshotReader</a>&nbsp;reader)</pre>
<div class="block">Installs a snapshot of the state machine state.
 <p>
 This method will be called while a server is replaying its log at startup. Typically, only the most
 recent snapshot of the state machine state will be installed upon log replay. State machines should recover
 all snapshottable state machine state from an installed snapshot.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>reader</code> - The snapshot reader.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/Snapshottable.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotStore.html" title="class in io.atomix.protocols.raft.storage.snapshot"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../io/atomix/protocols/raft/storage/snapshot/SnapshotWriter.html" title="class in io.atomix.protocols.raft.storage.snapshot"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?io/atomix/protocols/raft/storage/snapshot/Snapshottable.html" target="_top">Frames</a></li>
<li><a href="Snapshottable.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2013&#x2013;2018. All rights reserved.</small></p>
</body>
</html>
